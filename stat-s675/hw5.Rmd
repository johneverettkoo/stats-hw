---
title: "STAT-S675"
subtitle: 'Homework 5'
author: "John Koo"
output: pdf_document
# output: html_document
header-includes:
- \usepackage{float}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      comment = NA, 
                      warning = FALSE, 
                      message = FALSE, 
                      fig.pos = 'H', 
                      fig.align = 'center')
options(xtable.comment = FALSE, 
        xtable.table.placement = 'H')
```

# Problem 1

[Exercise 4.6.1 in the notes]

Want to show $\tau(\kappa(\Gamma)) = P \Gamma P$.

$P = (I - \frac{e e^T}{n})$  
$\tau(X) = -\frac{1}{2} PXP$  
$\kappa(X) = \text{diag}(X) e^T -  2 X + e \text{diag}(X)^T$

Since $\Gamma$ is a similarity matrix, $\text{diag}(\Gamma) = e$ (we can just 
normalize everything to this WLOG). 

$$\kappa(\Gamma) = \text{diag}(\Gamma) e^T -  2 \Gamma + e \text{diag}(\Gamma)^T$$
$$= e e^T - 2 \Gamma + e e^T$$
$$= 2(e e^T - \Gamma)$$

So if we want to find $\tau(\kappa(\Gamma))$:

$$\tau(\kappa(\Gamma)) = \tau(2(e e^T - \Gamma))$$
$$= -\frac{1}{2} P (2(e e^T - \Gamma)) P$$
$$= P (\Gamma - ee^T) P$$
$$= P \Gamma P - P ee^T P$$
So we just need to show that $P ee^T P = 0$. First, note that $e^T e = n$.

$$P ee^T P = (I - \frac{e e^T}{n}) ee^T (I - \frac{e e^T}{n})$$
$$= (I ee^T - \frac{ee^T ee^T}{n}) (I - \frac{e e^T}{n})$$
$$= (ee^T - \frac{n ee^t}{n}) (I - \frac{e e^T}{n})$$
$$= (ee^T - ee^T) (I - \frac{e e^T}{n})$$
$$= 0$$

Therefore $\tau(\kappa(\Gamma)) = P \Gamma P$.

# Problem 2

[Exercise 4.6.3 in the notes]

```{r p2_setup}
import::from(readr, read_table2)
import::from(magrittr, `%>%`, `%<>%`)
library(ggplot2)
import::from(GGally, ggpairs)
import::from(ggrepel, geom_label_repel)

# read the data
Delta <- read_table2('http://pages.iu.edu/~mtrosset/Courses/675/congress.dat', 
                    col_names = FALSE) %>% 
  as.matrix()

# code from the notes
Delta.cmds <- cmdscale(Delta, k = 3, eig = TRUE)
X <- Delta.cmds$points
```

## Part a

```{r p2_a}
r <- sum(Delta.cmds$eig > 0)
sum.pos.eig.vals <- sum(sapply(Delta.cmds$eig, function(i) max(i, 0)))
sum.neg.eig.vals <- sum(sapply(Delta.cmds$eig, function(i) min(i, 0)))
```

`r r` out of `r length(Delta.cmds$eig)` eigenvalues are positive. Using the 

## Part b

```{r p2_b}
sum(sort(Delta.cmds$eig, decreasing = TRUE)[1:2]) / sum.pos.eig.vals
sum(sort(Delta.cmds$eig, decreasing = TRUE)[1:3]) / sum.pos.eig.vals
```

Two eigenvalues is ~70\% of the sum of the positive eigenvalues while three is 
~80%. 

## Part c

```{r p2_c}
pairs(X, pch = as.character(seq(15)))

X.df <- X %>% 
  as.data.frame() %>% 
  dplyr::mutate(id = rownames(.))
```